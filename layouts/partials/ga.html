<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MYM83H0X5Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-MYM83H0X5Q');
</script>

<script>
  (function () {
    const eventThrottle = {};

    window.darEvent = function (name, params = {}) {
      const now = Date.now();

      // 1. Session-wide gate for interact_3d_model (Human intent)
      if (name === "interact_3d_model") {
        if (sessionStorage.getItem("dar_interact_3d_fired")) {
          return;
        }
        sessionStorage.setItem("dar_interact_3d_fired", "true");
      }

      // 2. Global Throttle: limit same event to once per 1000ms (Safety)
      if (eventThrottle[name] && (now - eventThrottle[name] < 1000)) {
        return;
      }
      eventThrottle[name] = now;

      if (typeof gtag === "function") {
        gtag("event", name, {
          ...params,
          page_location: window.location.href,
          page_title: document.title
        });
      }
    };
  })();
</script>