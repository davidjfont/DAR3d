<!-- Load Google Model Viewer -->
<script type="module" src="https://cdn.jsdelivr.net/npm/@google/model-viewer@3.3.0/dist/model-viewer.min.js"></script>

{{/* ----- RESOLUCIÓ DEL SRC ----- */}}
{{ $src := .src }}
{{ $cid := site.Params.glb_cid }}
{{ $base := site.Params.ipfsBase }}

{{/* Si no comença per http, assumim que és un glb_name */}}
{{ if and (not (hasPrefix $src "http")) (ne $src "") }}
  {{ $src = printf "%s%s/%s" $base $cid $src }}
{{ end }}

{{/* Evitar undefined / buit */}}
{{ if eq $src "" }}
  {{ $src = "/images/placeholder.glb" }}
{{ end }}

<model-viewer
    src="{{ $src }}"
    alt="{{ .alt | default `3D Model` }}"
    camera-controls
    auto-rotate
    auto-rotate-delay="0"
    shadow-intensity="1"
    exposure="0.0"
    tone-mapping="aces"
    environment-image="https://modelviewer.dev/assets/environments/neutral.hdr"
    interaction-prompt="none"
    interaction-prompt-style="none"
    touch-action="none"
    style="width:100%; height:100%; z-index:1000;">
</model-viewer>
