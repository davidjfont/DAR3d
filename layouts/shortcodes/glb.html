<!-- Load Google Model Viewer -->
<script type="module"
  src="https://cdn.jsdelivr.net/npm/@google/model-viewer@3.3.0/dist/model-viewer.min.js">
</script>

{{/* ----- RESOLUCIÃ“ DEL SRC ----- */}}
{{ $src := .src }}
{{ $cid := site.Params.glb_cid }}
{{ $base := site.Params.ipfsBase }}

{{ if and (not (hasPrefix $src "http")) (ne $src "") }}
  {{ $src = printf "%s%s/%s" $base $cid $src }}
{{ end }}

{{ if eq $src "" }}
  {{ $src = "/images/placeholder.glb" }}
{{ end }}

<model-viewer
    src="{{ $src }}"
    alt="{{ .alt | default `3D Model` }}"
    camera-controls
    auto-rotate
    auto-rotate-delay="0"
    shadow-intensity="1"
    exposure="0.0"
    tone-mapping="aces"
    environment-image="https://modelviewer.dev/assets/environments/neutral.hdr"
    interaction-prompt="none"
    interaction-prompt-style="none"
    touch-action="none"
    style="width:100%; height:100%; z-index:1000;"
>

    <!-- ðŸ§¬ LOADER DAR3D -->
    <div slot="poster" class="dar3d-loader">
      <img src="/svg/dar3d-loader.svg" alt="Cargando DAR3D">
      <span>Inicializando artefacto 3Dâ€¦</span>
      <span>Cargando {{ path.Base $src }}â€¦</span>
    </div>

</model-viewer>
